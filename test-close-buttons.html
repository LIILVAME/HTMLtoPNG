<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Close Buttons</title>
    <style>
        .feature-section {
            display: none;
            position: fixed;
            top: 50px;
            right: 20px;
            width: 300px;
            background: white;
            border: 1px solid #ccc;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            z-index: 1000;
            opacity: 0;
            transform: translateX(100%);
            transition: all 0.3s ease;
        }
        
        .feature-section.active {
            opacity: 1;
            transform: translateX(0);
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }
        
        .close-section {
            background: none;
            border: none;
            font-size: 18px;
            cursor: pointer;
            color: #666;
            padding: 5px;
            border-radius: 4px;
        }
        
        .close-section:hover {
            background: #f0f0f0;
            color: #333;
        }
        
        .test-buttons {
            margin: 20px;
        }
        
        .test-btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .test-btn:hover {
            background: #0056b3;
        }
        
        .debug-info {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 10px;
            font-family: monospace;
            font-size: 12px;
            max-width: 400px;
            max-height: 200px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="test-buttons">
        <h1>Test des Boutons de Fermeture</h1>
        <button class="test-btn" onclick="openSection('testSection1')">Ouvrir Section 1</button>
        <button class="test-btn" onclick="openSection('testSection2')">Ouvrir Section 2</button>
        <button class="test-btn" onclick="clearDebug()">Effacer Debug</button>
    </div>
    
    <!-- Test Section 1 -->
    <div class="feature-section" id="testSection1">
        <div class="section-header">
            <h3>Section de Test 1</h3>
            <button class="close-section" data-close-section>
                ✕
            </button>
        </div>
        <p>Ceci est la section de test 1. Cliquez sur le bouton X pour fermer.</p>
    </div>
    
    <!-- Test Section 2 -->
    <div class="feature-section" id="testSection2">
        <div class="section-header">
            <h3>Section de Test 2</h3>
            <button class="close-section" data-close-section>
                ✕
            </button>
        </div>
        <p>Ceci est la section de test 2. Cliquez sur le bouton X pour fermer.</p>
    </div>
    
    <div class="debug-info" id="debugInfo">
        <strong>Debug Info:</strong><br>
        Page chargée...<br>
    </div>
    
    <script>
        // Debug logging
        function addDebugLog(message) {
            const debugInfo = document.getElementById('debugInfo');
            const timestamp = new Date().toLocaleTimeString();
            debugInfo.innerHTML += `[${timestamp}] ${message}<br>`;
            debugInfo.scrollTop = debugInfo.scrollHeight;
        }
        
        function clearDebug() {
            document.getElementById('debugInfo').innerHTML = '<strong>Debug Info:</strong><br>Debug effacé...<br>';
        }
        
        // Function to open sections
        function openSection(sectionId) {
            addDebugLog(`Ouverture de la section: ${sectionId}`);
            const section = document.getElementById(sectionId);
            if (section) {
                section.style.display = 'block';
                setTimeout(() => {
                    section.classList.add('active');
                    addDebugLog(`Section ${sectionId} activée`);
                }, 10);
            }
        }
        
        // Setup close section buttons - Version de test
        function setupCloseSectionButtons() {
            addDebugLog('Initialisation des boutons de fermeture...');
            
            // Use event delegation for better performance and reliability
            document.addEventListener('click', (e) => {
                addDebugLog(`Clic détecté sur: ${e.target.tagName} ${e.target.className}`);
                
                // Check if clicked element is a close button or inside one
                const closeButton = e.target.closest('[data-close-section]');
                
                if (closeButton) {
                    addDebugLog('Bouton de fermeture détecté!');
                    e.preventDefault();
                    e.stopPropagation();
                    
                    // Find the parent feature section
                    const section = closeButton.closest('.feature-section');
                    
                    if (section) {
                        addDebugLog(`Section trouvée: ${section.id}`);
                        
                        // Remove active class to trigger CSS transition
                        section.classList.remove('active');
                        addDebugLog('Classe active supprimée');
                        
                        // Hide section after transition completes
                        setTimeout(() => {
                            section.style.display = 'none';
                            addDebugLog(`Section ${section.id} masquée`);
                        }, 300);
                    } else {
                        addDebugLog('Aucune section parente trouvée!');
                    }
                } else {
                    addDebugLog('Pas un bouton de fermeture');
                }
            }, true); // Use capture phase to ensure we catch the event first
            
            addDebugLog('Écouteur d\'événements ajouté');
        }
        
        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', () => {
            addDebugLog('DOM chargé');
            setupCloseSectionButtons();
        });
        
        addDebugLog('Script chargé');
    </script>
</body>
</html>